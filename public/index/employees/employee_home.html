<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Western Express: Employee Portal</title>
    <link rel="stylesheet" href="\css\employees\employee_home.css" />
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=DM Sans">
    <style>
      
    </style>
  </head>
  <body>
    <div class="transparent-background"></div>
    <header class="employee-portal-header">
      <h1><strong>Employee Portal</strong></h1>
    </header>
    <hr class="horizontal-line" />

    <div class="container">
      <nav class="side-nav">
        <ul>
          <li><a href="#" onclick="loadContent('home')">Home</a></li>
          <li><a href="#" onclick="loadContent('tracking')">Tracking</a></li>
          <li><a href="#" onclick="loadContent('ReceivePackage')">Receive Package</a></li>
          <li><a href="#" onclick="loadContent('packages')">Packages Overview</a></li>
          <li><a href="#" onclick="loadContent('personal-data')">Personal Report</a></li>
          <li><a href="#" onclick="loadContent('support')">Support Tickets</a></li>
          <!--<li><a href="#" onclick="loadContent('post office')">Post-Offices</a></li>-->
          <li><a href="#" onclick="loadContent('clockin-clockout')">Clock In/Clock Out</a></li>
          <li><a href="#" onclick="loadContent('create-label')">Create Label</a></li>
          <li><a href="#" onclick="signOut()">Sign Out</a></li>
          <script>
            function signOut() {
                // Perform logout logic here, e.g., clearing session storage, etc.
        
                // Redirect to index.html after logout
                window.location.href = "/index.html";
            }
          </script>
        </ul>
      </nav>
      <main class="content">
        <div id="home">
          <div class="background-container">
            <h1>Western Express Postal: Employee Portal</h1>
            <!--<div class="track-package">
              <input type="text" placeholder="Enter tracking number" />
              <button>Track</button>
            </div>-->
          </div>
          <div class="services">
            <h2>Services Overview</h2>
            <h3>Priority Mail Express</h3>
            <p>
              Perfect for sending urgent mails or packages within 1-2 days.
              Money back guaranteed if it doesn’t arrive by delivery date Price:
              Starts at $27.75 Delivery Speed: Next day to 2 days Weight: Up to
              70lbs
            </p>
            <h3>Priority Mail</h3>
            <p>
              You need to send something important that need to arrive within 1
              to 3 business days Price: Flat Rate Envelop: From $8.65 Mailing
              Box: From $9.20 Your Own Box by Weight: From $9.35 Delivery Speed:
              1-2 days Weight: Up to 70lbs
            </p>
            <h3>Ground</h3>
            <p>
              Low rates for packages that only need to be delivered within 2-5
              days. Good option for HAZMAT items that can’t travel by air.
              Price: From $4.25 Delivery Speed: 2-5 days Weight: Up to 70lbs
              inside the US. Packages up to 15.999 oz is priced by ounces.
            </p>
            <h3>First Class</h3>
            <p>
              For sending letter envelops (below 3.5oz) or large envelop (below
              13 oz) that can flatten and bend. Price: Postcards: $0.41 Letters:
              $0.56 Large Envelops: $1.25 Delivery Speed: 2-5 days Weight:
              Single-piece envelops weighs up 10 3.5oz, and large envelops up to
              13oz.
            </p>
            <h3>Media Class</h3>
            <p>
              Sending books, medias, and educational materials for an affordable
              price. Can only be shipped in store. Items are subjected to be
              inspected at Postal Service Price: From $3.75 Delivery Speed: 2-8
              days Weight: Up to 70lbs
            </p>
            <div class="contactinfo">
              <p>Western Express Postal Service</p>
              <p>CONTACT INFORMATION</p>
              <p>Email: westernexpresspostal@outlook.net</p>
              <p>Location's Phone Number: (888) 777 6666</p>
              <p>Manager's Phone Number: (666) 555 4444</p>
            </div>
          </div>
        </div>
        <div id="tracking">
          <div class="tracking-nav">
            <button class="view-tracking-btn clicked-button" id="view-tracking-btn" onclick="toggleTrackingMenu('view-tracking')">View Tracking History</button>
            <button class="update-tracking-btn" id="update-tracking-btn" onclick="toggleTrackingMenu('update-tracking')">Update Tracking History</button>
          </div>
          <div class="view-tracking" id="view-tracking">
            <form class="view-tracking-form" id="view-tracking-form" action="#">
              <label for="view-tracking-input" class="view-tracking-label">Tracking ID</label>
              <input type="text" name="view-tracking-input" id="view-tracking-input" class="view-tracking-input" placeholder="" required />
            </form>
            <div class="view-tracking-submit-container">
              <button id="view-tracking-submit" onClick="viewTracking(); return false" class="view-tracking-submit">SUBMIT</button>
            </div>
            <div id="tracking-table"></div>
          </div>
          <div class="update-tracking hidden" id="update-tracking">
            <form class="update-tracking-form" id="update-tracking-form" action="#">
              <label for="update-tracking-employee" class="update-tracking-label">Employee ID</label>
              <input type="text" name="update-tracking-employee" id="update-tracking-employee" class="update-input" placeholder="" required />
              <label for="update-tracking-input" class="update-tracking-label">Tracking ID</label>
              <input type="text" name="update-tracking-input" id="update-tracking-input" class="update-input" placeholder="" required />
              <label for="update-tracking-status" class="update-tracking-label">Status</label>
              <select name="update-tracking-status" id="update-tracking-status" class="update-input"> 
                <option value="PROCESSED">PROCESSED</option> 
                <option value="SHIPPED">SHIPPED</option> 
                <option value="IN TRANSIT">IN TRANSIT</option>
                <option value="ARRIVED">ARRIVED</option> 
                <option value="DELAY">DELAY</option> 
              </select>
            </form>
            <div class="update-tracking-submit-container">
              <button id="update-tracking-submit" onClick="updateTracking(); return false" class="update-tracking-submit">SUBMIT</button>
            </div>
          </div>
        </div>
        <div id="ReceivePackage">
          <p>
            Scans and updates package status to "ARRIVED AT FACILITY".
          </p>
          <form id="receivepackage_" action="/incomingpackages" method="POST" style="display: flex; flex-direction: column;">
              <label class="support-label" for="trackingNumberInput">Enter Tracking Number:</label>
              <input type="text" id="trackingNumberInput" name="trackingNumberInput" class="support-credentials-input" placeholder="Scan tracking number">
              <button class="support-credentials-submit" type="button" onclick="scanPackage()">Scan Package</button>
          </form>
        </div>
        <div id="packages">
          <h2>Packages Overview</h2>
            <form class="package-overview-form" id="package-overview-form">
                <div class="page">
                  <div class="container1">
                      <h3>From</h3>
                      <input type="date" id="startDate">
                      <h3>To</h3>
                      <input type="date" id="endDate">
                  </div>
                  <div class="container2">
                      <h3>Class Types</h3>
                      <label>
                        <select id="packageType" name="packageType">
                          <option value="">Choose an option</option>
                          <option value="Priority Mail Express">Priority Mail Express</option>
                          <option value="Priority Mail">Priority Mail</option>
                          <option value="Ground">Ground</option>
                          <option value="First Class">First Class</option>
                          <option value="Media Class">Media Class</option>
                        </select>
                      <h3>Status</h3>
                      <label>
                        <select id="packageStatus" name="status">
                          <option value="">Choose an option</option>
                          <option value="PROCESSED">Processed</option>
                          <option value="SHIPPED">Shipped</option>
                          <option value="IN TRANSIT">In Transit</option>
                          <option value="ARRIVED">Arrived</option>
                          <option value="DELAY">Delay</option>
                      </select>
                    </label>
                  </div>
              </div>
              <div class="submit_button">
                <button type="button" id="package_button" onClick="overviewReport()" class="package_button">View</button>
              </div>
            </form>
            <h2>Overview:</h2>
            <div id="package_overview"></div>
        </div>
        <div id="personal-data">
          <div class="empPage">
            <h2>Employee Sales</h2>
            <input type="text" id="searchInput" placeholder="Search..." oninput="handleSearch()">
          </div>
            <div id="employeeData"></div>
        </div>
        <div id="financial_report">
          <h2>Store Financial Report</h2>
          <form class ="store-report" id = "store-report">

          </form>
        </div>
        <div id="support">
          <div class="support-box" id="support-box">
            <form class="support-credentials-form" id="support-credentials-form" action="#">
              <label for="support-credentials-input" class="support-credentials-label">Enter Password To Access Support Tickets</label>
              <input type="text" name="support-credentials-input" id="support-credentials-input" class="support-credentials-input" placeholder="" required />
              <div class="support-credentials-submit-container">
                <button id="support-credentials-submit" onclick="openSupportTicketTable(); return false;" class="support-credentials-submit">SUBMIT</button>
              </div>
            </form>
          </div>
          <div class="support-tickets-container hidden" id="support-tickets-container">
            <div class="support-table-header">
              <span class="support-name">Support Ticket Dashboard</span>
            </div>
              <div id="supportTable">
              </div>
          </div>
          <div class="view-support-ticket hidden">
              <div class="close-button-container">
                <span class="ticket-number-title" id="ticket-number-title-1">
                </span>
                <button class="close-view-button" onclick="closeTicket();">
                  &#215
                </button>
              </div>
              <div class="ticket-header">
                <div class="ticket-header-info">
                  <span class="ticket-title"></span>
                  <span class="ticket-email"></span>
                  <span class="ticket-date"></span>
                </div>
              </div>
              <div class="ticket-description-container">
                <label class="support-label">Description</label>
                <p class="ticket-description"></p>
              </div>
          </div>
          <div class="update-support-ticket hidden">
            <div class="close-button-container">
              <span class="ticket-number-title" id="ticket-number-title-2">
              </span>
              <button class="close-update-button" onclick="closeForm();">
                &#215
              </button>
            </div>
            <form class="update-support-status-form">
              <label class="support-label">New Status (required)</label>
              <select class="update-input" id="update-ticket-status"> 
                <option value="IN PROGRESS">IN PROGRESS</option> 
                <option value="ON HOLD">ON HOLD</option>
                <option value="CLOSE">CLOSE</option> 
              </select>
              <label class="support-label">Reply (required)</label>
              <textarea class="update-input" id="update-ticket-reply" required></textarea>
              <div class="update-tracking-submit-container">
                <button id="update-ticket-submit" onClick="updateTicket(); return false" class="update-tracking-submit">SUBMIT</button>
              </div>
            </form>
          </div>
        </div>
        <div id="manager reports">
          <div id="reports">
            <div class="sales">
              <h2>Sales Report Generator</h2>
  
              <div id="reportForm">
                <div class="fieldBox">
                  <label>
                    <input type="checkbox" id="fieldAmount" /> Amount
                  </label>
                  <select id="amountComparison" name="amountComparison">
                    <option value="equal">Equal to</option>
                    <option value="greater">Greater than</option>
                    <option value="less">Less than</option>
                  </select>
                  <input type="number" id="amount" name="amount" />
                </div>
  
                <div class="fieldBox">
                  <label>
                    <input type="checkbox" id="fieldLocation" /> Location
                  </label>
                  <select id="location" name="location">
                    <option disabled selected value="">Select a location</option>
                    <option value="location1">
                      4516 Burleson Rd, Austin, TX 78744
                    </option>
                    <option value="location2">
                      3740 Greenbriar Dr, Houston, TX 77098
                    </option>
                    <option value="location3">
                      515 Centre St, Dallas, TX 75208
                    </option>
                    <option value="location4">
                      219 E Mills Ave, El Paso, TX 79901
                    </option>
                    <option value="location5">
                      5001 Avenue L, Lubbock, TX 79452
                    </option>
                    <option value="location6">
                      3903 Melear Dr, Arlington, TX 76015
                    </option>
                    <option value="location7">
                      1140 S Laredo St, San Antonio, TX 78204
                    </option>
                    <option value="location8">
                      5200 W University Blvd, Odessa, TX 79764
                    </option>
                    <option value="location9">
                      10515 Stonewall Blvd, Corpus Christi, TX 78410
                    </option>
                    <option value="location10">
                      423 Los Alamos Dr, Alamo, TX 78516
                    </option>
                  </select>
                </div>
  
                <div class="fieldBox">
                  <label> <input type="checkbox" id="fieldDate" /> Date </label>
                  <select id="dateComparison" name="dateComparison">
                    <option value="on">On</option>
                    <option value="before">Before</option>
                    <option value="after">After</option>
                  </select>
                  <input type="date" id="date" name="date" />
                </div>
  
                <div class="fieldBox">
                  <label>
                    <input type="checkbox" id="fieldEmployeeId" /> Employee ID
                  </label>
                  <input type="text" id="employeeId" name="employeeId" />
                </div>
  
                <button onclick="generateReport()">Generate Report</button>
              </div>
  
              <div id="result">
                <h3>Generated Report:</h3>
                <ul id="reportList"></ul>
              </div>
            </div>
          </div>
        </div>
        <div id="clockin-clockout">
          <div class="clockin">
            <div class="clock" id="clock">
              <div class="date-time">
                <span id='time-clock'></span>
                <span id='date-clock'></span>
              </div>
              <div class="shift-time">
                <span class="shift-start">Shift Start</span>
                <span id="shift-start">--:--:--</span>
                <span class="shift-end">Shift End</span>
                <span id="shift-end">--:--:--</span>
              </div>
            </div>
            <form class="clockin-form" id="clockin-form" action="#">
              <label for="clockin-user-input" class="clockin-label">Enter username</label>
              <input type="text" name="clockin-user-input" id="clockin-user-input" class="clockin-user-input" placeholder="" required />
              <label for="clockin-pass-input" class="clockin-label">Enter password</label>
              <input type="text" name="clockin-pass-input" id="clockin-pass-input" class="clockin-pass-input" placeholder="" required />
            </form>
            <div class="clockin-clockout-btns">
              <button id="clockin-submit" onClick="clockIn(); return false" class="clockin-submit">Clock In</button>
              <button id="clockout-submit" onClick="clockOut(); return false" class="clockout-submit">Clock Out</button>
            </div>
          </div>
          <!--<div class="clockout">
            <h1 class="clockout-header">Clock Out</h1>
            <form class="" id="clockout-form" action="#" style="display: block;">
              <label for="clockout-user-input" class="clockout-user-label">Enter username:</label>
              <input type="text" name="clockout-user-input" id="clockout-user-input" class="" placeholder="" required />
              <label for="clockout-pass-input" class="clockout-pass-label">Enter password:</label>
              <input type="text" name="clockout-pass-input" id="clockout-pass-input" class="" placeholder="" required />
              <button id="clockout-submit" onClick="clockOut(); return false" class="">Clock Out</button>
            </form>
          </div>-->
        </div>
        <div id="create-label">
          <form class='create-label-form' action="/employee/createlabel" method="POST">

            <h2 class="create-label-h2">Ship From:</h2>
            <label class="create-label-label" for="fromCountry">Country:</label>
            <select class="create-label-select" id="fromCountry" name="fromCountry" defaultValue="USA">
                <option value="USA">USA</option>
                <!-- Add other countries if needed -->
            </select><br>
            <label class="create-label-label" for="fromFirstName">First Name:</label>
            <input class="create-label-input" type="text" id="fromFirstName" name="fromFirstName" required><br>
            <label class="create-label-label" for="fromLastName">Last Name:</label>
            <input class="create-label-input" type="text" id="fromLastName" name="fromLastName" required><br>
            <label class="create-label-label" for="fromAddress">Address Line:</label>
            <input class="create-label-input" type="text" id="fromAddress" name="fromAddress" required><br>
            <label class="create-label-label" for="fromZip">Zipcode:</label>
            <input class="create-label-input" type="text" id="fromZip" name="fromZip" required><br>
            <label class="create-label-label" for="fromCity">City:</label>
            <input class="create-label-input" type="text" id="fromCity" name="fromCity" required><br>
            <label class="create-label-label" for="fromState">State:</label>
            <select class="create-label-select" id="fromState" name="fromState">
                <!-- Add all USA states -->
                <option value="AL">Alabama</option>
                <option value="AK">Alaska</option>
                <option value="AL">Alabama</option>
                <option value="AK">Alaska</option>
                <option value="AZ">Arizona</option>
                <option value="AR">Arkansas</option>
                <option value="CA">California</option>
                <option value="CO">Colorado</option>
                <option value="CT">Connecticut</option>
                <option value="DE">Delaware</option>
                <option value="FL">Florida</option>
                <option value="GA">Georgia</option>
                <option value="HI">Hawaii</option>
                <option value="ID">Idaho</option>
                <option value="IL">Illinois</option>
                <option value="IN">Indiana</option>
                <option value="IA">Iowa</option>
                <option value="KS">Kansas</option>
                <option value="KY">Kentucky</option>
                <option value="LA">Louisiana</option>
                <option value="ME">Maine</option>
                <option value="MD">Maryland</option>
                <option value="MA">Massachusetts</option>
                <option value="MI">Michigan</option>
                <option value="MN">Minnesota</option>
                <option value="MS">Mississippi</option>
                <option value="MO">Missouri</option>
                <option value="MT">Montana</option>
                <option value="NE">Nebraska</option>
                <option value="NV">Nevada</option>
                <option value="NH">New Hampshire</option>
                <option value="NJ">New Jersey</option>
                <option value="NM">New Mexico</option>
                <option value="NY">New York</option>
                <option value="NC">North Carolina</option>
                <option value="ND">North Dakota</option>
                <option value="OH">Ohio</option>
                <option value="OK">Oklahoma</option>
                <option value="OR">Oregon</option>
                <option value="PA">Pennsylvania</option>
                <option value="RI">Rhode Island</option>
                <option value="SC">South Carolina</option>
                <option value="SD">South Dakota</option>
                <option value="TN">Tennessee</option>
                <option value="TX">Texas</option>
                <option value="UT">Utah</option>
                <option value="VT">Vermont</option>
                <option value="VA">Virginia</option>
                <option value="WA">Washington</option>
                <option value="WV">West Virginia</option>
                <option value="WI">Wisconsin</option>
                <option value="WY">Wyoming</option>
            </select><br>
    
    
            <label class="create-label-label" for="fromEmail">Email:</label>
            <input class="create-label-input"  type="email" id="fromEmail" name="fromEmail" required><br>
      
    
        
        
        
        
            <h2 class="create-label-h2" >Ship To:</h2>
            <!-- Similar fields for Ship To -->
            <label class="create-label-label" for="toCountry">Country:</label>
            <select class="create-label-select" id="toCountry" name="toCountry" defaultValue="USA">
                <option value="USA">USA</option>
                <!-- Add other countries if needed -->
            </select><br>
            <label class="create-label-label" for="toFirstName">First Name:</label>
            <input class="create-label-input"  type="text" id="toFirstName" name="toFirstName" required><br>
            <label class="create-label-label" for="toLastName">Last Name:</label>
            <input class="create-label-input"  type="text" id="toLastName" name="toLastName" required><br>
            <label class="create-label-label" for="toAddress">Address Line:</label>
            <input class="create-label-input"  type="text" id="toAddress" name="toAddress" required><br>
            <label class="create-label-label" for="toZip">Zipcode:</label>
            <input class="create-label-input"  type="text" id="toZip" name="toZip" required><br>
            <label class="create-label-label" for="toCity">City:</label>
            <input class="create-label-input"  type="text" id="toCity" name="toCity" required><br>
            <label class="create-label-label" for="toState">State:</label>
            <select class="create-label-select" id="toState" name="toState">
                <!-- Add all USA states -->
                <option value="AL">Alabama</option>
                <option value="AK">Alaska</option>
                <!-- Add other states here -->
            </select><br>
            <label class="create-label-label" for="toEmail">Email:</label>
            <input class="create-label-input" type="email" id="toEmail" name="toEmail" required><br>
        
    
        
        
        
        
            <h2 class="create-label-h2" >Details:</h2>
            <label class="create-label-label" for="description">Description:</label>
            <input class="create-label-input" type="text" id="description" name="description" required><br>
            <label class="create-label-label" for="dimensions">Dimensions:</label>
            <input class="create-label-input" type="text" id="dimensions" name="dimensions" required><br>
            <label class="create-label-label" for="weight">Weight:</label>
            <input class="create-label-input" type="text" id="weight" name="weight" required><br>
    
            <h2 class="create-label-h2" >Method:</h2>
            <label class="create-label-label"  for="method">Select Method:</label>
            <select class="create-label-select" id="method" name="method">
                <option value="first">First</option>
                <option value="2nd day">2nd Day</option>
                <option value="economy">Economy</option>
            </select><br>
    
            <h2 class="create-label-h2">Cost:</h2>
            <!-- Display cost based on the selected method -->
            <label class="create-label-label" for="cost">Cost:</label>
            <input class="create-label-input" type="text" id="cost" name="cost" readonly><br>
    
            
            
            
            <script>
                // Function to update cost based on the selected method
                document.getElementById('method').addEventListener('change', function() {
                    var method = this.value;
                    var costInput = document.getElementById('cost');
                    
                    if (method === 'first') {
                        costInput.value = '44.00';
                    } else if (method === '2nd day') {
                        costInput.value = '34.00';
                    } else if (method === 'economy') {
                        costInput.value = '19.00';
                    }
                });
            </script>
    
            <input type="submit" value="Submit">
            </form>
        </div>
      </main>
    </div>
    <script>
      // Your JavaScript code here
      const links = document.querySelectorAll(".side-nav a");

      links.forEach((link) => {
        link.addEventListener("click", (event) => {
          event.preventDefault(); // Prevent the default link behavior (optional)

          // Remove the "clicked" class from all links
          links.forEach((otherLink) => {
            otherLink.classList.remove("clicked");
          });

          // Add the "clicked" class to the clicked link
          link.classList.add("clicked");
        });
      });

      function loadContent(contentId) {
        // Hide all content div
        const contentDivs = document.querySelectorAll(".content > div");
        contentDivs.forEach((div) => {
          div.style.display = "none";
        });

        // Show the selected content
        document.getElementById(contentId).style.display = "block";
      }
      // Set the "Home" link to be lit up by default
      const homeLink = document.querySelector(".side-nav a[href='#']");
      homeLink.classList.add("clicked");
      loadContent("home");
      /*               JAVASCRIPT FOR EMPLOYEE HOME PAGE                */

      /************************** HORIZONTAL LINE ***************************************************************/
      //mkaes the shadow appear when scrolling
      const horizontalLine = document.querySelector(".horizontal-line");

      //const BASE_URL = 'http://localhost:5500';
      const BASE_URL = 'https://westernexpresspostal.azurewebsites.net';

      async function checkForAlert(){
        fetch(`${BASE_URL}/alerts`)
        .then(response => response.json())
        .then(data => {
            if(typeof data.trigger_message != 'undefined'){
                alert(data.trigger_message);
            }
        })
      };

      window.addEventListener("scroll", () => {
        // Check if the user has scrolled down a certain distance (e.g., 100px)
        if (window.scrollY > 100) {
          horizontalLine.classList.add("has-shadow");
        } else {
          horizontalLine.classList.remove("has-shadow");
        }
      });

      /*************************************************************************************************************/
      
      let employeeData = []; // Store the fetched employee data


async function fetchEmployeeData() {
  try {
    const response = await fetch(`${BASE_URL}/employeeData`);
    employeeData = await response.json();
    console.log(employeeData);
    renderTable(employeeData);
  } catch (error) {
    console.error("Fetch error: ", error);
  }
}

document.addEventListener("DOMContentLoaded", fetchEmployeeData);


function handleSearch() {
  const searchInput = document.getElementById('searchInput').value.toLowerCase();
  const filteredData = employeeData.filter(item => {
    for (let key in item) {
      if (item[key].toString().toLowerCase().includes(searchInput)) {
        return true;
      }
    }
    return false;
  });
  renderTable(filteredData);
}


function renderTable(tableData) {
  const tableContainer = document.getElementById('employeeData');
  console.log(tableData[0]);
  const col = Object.keys(tableData[0]);
  const table = document.createElement('table');
  //table.classList.add('report-table');
  const tr = table.insertRow(-1);


  // Code to create table headers
  for (let i = 0; i < col.length; i++) {
    const th = document.createElement('th');
    //th.classList.add('report-th');
    th.innerHTML = col[i];
    tr.appendChild(th);
  }


  // Code to populate table rows with data
  for (let i = 0; i < tableData.length; i++) {
    const tr = table.insertRow(-1);
    for (let j = 0; j < col.length; j++) {
      const tabCell = tr.insertCell(-1);
      //tabCell.classList.add('report-td');
      if (col[j] === 'Sale Date') {
        const dateValue = new Date(tableData[i][col[j]]);
        tabCell.innerHTML = dateValue.toISOString().split('T')[0];
      } else {
        tabCell.innerHTML = tableData[i][col[j]];
      }
    }
  }


  // Clear the previous table content and append the new table
  tableContainer.innerHTML = "";
  tableContainer.appendChild(table);
}




      const support_box = document.querySelector('.support-box');
      const cred_btn = document.querySelector('.support-credentials-submit');
      const support_tickets = document.querySelector('.support-tickets-container');

      async function openSupportTicketTable(){
        const password = document.getElementById('support-credentials-input').value;
        console.log(password);
        const data = {
          'password' : password
        }

        fetch(`${BASE_URL}/employee-support`,
          {
            headers : {
              "Content-type": "application/json; charset=UTF-8"
            },
            method: 'POST',
            body: JSON.stringify(data)
          })
          .then(response => response.json())
          .then(data => {
            if(typeof data.alert === 'undefined'){
              supportTickets(data[0], 'supportTable');
              support_box.classList.add("hidden");
              support_tickets.classList.remove("hidden");
            }
            else{
              alert('Your credentials indicate you are not a support agent.'); 
            }
        })
        .catch(error => (console.error('Fetch error:', error)));	
      }

      function scanPackage() {
          // Get the tracking number from the input field
          const trackingNumber = document.getElementById('trackingNumberInput').value;


          // Make sure the tracking number is not empty
          if (!trackingNumber) {
              alert('Please enter a tracking number');
              return;
          }


          // Create a FormData object and append the tracking number to it
          const formData = new URLSearchParams();
          formData.append('trackingNumberInput', trackingNumber);


          // Make an AJAX request to submit the form
          fetch('/incomingpackages', {
              method: 'POST',
              headers: {'Content-Type': 'application/x-www-form-urlencoded',},
              body: formData
          })
          .then(response => response.json())
          .then(data => {
              if (data.success) {
                  // Show a success message on the screen
                  displaySuccessMessage(data.message);
              } else {
                  // Show an error message on the screen
                  displayErrorMessage('Operation failed: ' + data.message);
              }
          })
          .catch(error => {
              console.error(error);
              // Show an error message on the screen
              displayErrorMessage('The tracking number already exists');
          });
      }


      function displaySuccessMessage(message) {
          // Customize how you want to display the success message
          alert(message);
      }


      function displayErrorMessage(message) {
          // Customize how you want to display the error message
          alert(message);
      }

      async function closeTicket(){
        const view_ticket = document.querySelector('.view-support-ticket');
        view_ticket.classList.add('hidden');
      }

      async function closeForm(){
        const update_ticket = document.querySelector('.update-support-ticket');
        update_ticket.classList.add('hidden');
      }

      function viewTicket(ticket_number){
        const ticket_title = document.querySelector('.ticket-title');
        const ticket_email = document.querySelector('.ticket-email');
        const ticket_date = document.querySelector('.ticket-date');
        const ticket_description = document.querySelector('.ticket-description');
        const view_ticket = document.querySelector('.view-support-ticket');
        const ticket_number_title = document.getElementById('ticket-number-title-1');
        ticket_number_title.innerHTML = `Viewing Ticket #${ticket_number}`;

        const data = {
          'ticket_number': ticket_number
        };

        fetch(`${BASE_URL}/viewTicket`, {
          headers : {
            "Content-type": "application/json; charset=UTF-8"
          },
          method : 'POST',
          body : JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
          if(typeof data.alert === 'undefined'){
            ticket_title.innerHTML = data[0][0]['title'];
            ticket_email.innerHTML = data[0][0]['email'];
            ticket_date.innerHTML = data[0][0]['date'];
            ticket_description.innerHTML = data[0][0]['description'];
            if(view_ticket.classList.contains('hidden')){
              view_ticket.classList.remove('hidden');
            }
          }
          else{
            alert('Alert'); 
          }
        })
        .catch(error => (console.error('Fetch error:', error)));	
      }

      const update_ticket_btn = document.getElementById('update-ticket-submit');
      function openUpdateTicketForm(ticket_number){
        const update_ticket = document.querySelector('.update-support-ticket');
        const ticket_number_title = document.getElementById('ticket-number-title-2');
        ticket_number_title.innerHTML = `Updating Ticket #${ticket_number}`;
        if(update_ticket.classList.contains('hidden')){
          update_ticket.classList.remove('hidden');
        }
        update_ticket_btn.setAttribute('data-id', ticket_number);
      }

      async function updateTicket(){
        let status = document.getElementById('update-ticket-status').value;
        let reply = document.getElementById('update-ticket-reply').value;

        let data = {
          'status' : status,
          'reply' : reply,
          'ticket_number' : update_ticket_btn.getAttribute('data-id')
        }

        fetch(`${BASE_URL}/updateTicket`, {
          headers : {
            "Content-type": "application/json; charset=UTF-8"
          },
          method : 'POST',
          body : JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
          if(typeof data.alert === 'undefined'){
            alert('successfully updated the ticket!');
          }
          else{
            alert('wrong'); 
          }
        })
        .catch(error => (console.error('Fetch error:', error)));	

      };

      //update_tracking_btn.addEventListener('click', updateTicket);

      /**************************** EMPLOYEE TRACKING PAGE**********************************************************/
      function viewTracking(){
        let tracking_id = document.getElementById('view-tracking-input').value;
        const tracking_id_span = document.getElementById('tracking-id');
        //tracking_id_span.innerHTML = tracking_id;

        fetch(`${BASE_URL}/track/history/${tracking_id}`,
          {
            method: 'GET'
          })
          .then(response => response.json())
          .then(data => {
            if(typeof data.alert === 'undefined'){
              JSONToHTMLTable(data[0], "tracking-table");
            }
            else{
              alert('The tracking ID you sent does not exist!'); 
            }
          })
          .catch(error => (console.error('Fetch error:', error)));	
      }

      function updateTracking(){

        let tracking_id = document.getElementById('update-tracking-input').value;
        let employee_id = document.getElementById('update-tracking-employee').value;
        let status = document.getElementById('update-tracking-status').value;

        const data = {
          'tracking_id': tracking_id,
          'employee_id': employee_id,
          'status': status
        };

        fetch(`${BASE_URL}/track/update`, {
          headers : {
            "Content-type": "application/json; charset=UTF-8"
          },
          method : 'POST',
          body : JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
          if(typeof data.alert === 'undefined'){
            alert(`Tracking for #${tracking_id} was successfully updated!`);
          }
          else{
            alert('The tracking ID you sent does not exist!'); 
          }
        })
        .catch(error => (console.error('Fetch error:', error)));	
      }
      
      function supportTickets(data, elementToBind) {           
        var col = [];
        for (var i = 0; i < data.length; i++) {
          for (var key in data[i]) {
            if (col.indexOf(key) === -1) {
              col.push(key);
            }
          }
        }
        //This Code creates HTML table
        var table = document.createElement("table");
        table.classList.add('support-table');

        //This Code getsrows for header creator above.
        var tr = table.insertRow(-1);
        tr.classList.add('support-tr-header');

        for (var i = 0; i < col.length; i++) {
          var th = document.createElement("th");
          th.classList.add('support-th');
          th.innerHTML = col[i];
          tr.appendChild(th);
        }

        //This Code adds data to table as rows
        for (var i = 0; i < data.length; i++) {

          tr = table.insertRow(-1);
          tr.classList.add('support-tr');

          for (var j = 0; j < col.length; j++) {
            var tabCell = tr.insertCell(-1);
            tabCell.innerHTML = data[i][col[j]];
          }

          var viewCell = tr.insertCell(-1);
          var viewBtn = document.createElement("button");
          viewBtn.textContent = 'VIEW';
          viewBtn.setAttribute('onclick', `viewTicket(${data[i][col[0]]});`);
          viewBtn.classList.add('support-view-btn');
          viewCell.appendChild(viewBtn);


          var updateCell = tr.insertCell(-1);
          var updateBtn = document.createElement("button");
          updateBtn.textContent = 'UPDATE';
          updateBtn.setAttribute('onclick', `openUpdateTicketForm(${data[i][col[0]]});`);
          updateBtn.classList.add('support-update-btn');
          updateCell.appendChild(updateBtn);
        }

        //This Code gets the all columns for header
  
        var divContainer = document.getElementById(elementToBind);
        if(divContainer.hasChildNodes()){
          divContainer.replaceChildren(table);
        }
        else{
          divContainer.appendChild(table);
        }
      }

function JSONToHTMLTable(data, elementToBind) {           
  var col = [];
  for (var i = 0; i < data.length; i++) {
    for (var key in data[i]) {
      if (col.indexOf(key) === -1) {
        col.push(key);
      }
    }
  }

  //This Code creates HTML table
  var table = document.createElement("table");

  //This Code getsrows for header creator above.
  var tr = table.insertRow(-1);

  for (var i = 0; i < col.length; i++) {
    var th = document.createElement("th");
    th.innerHTML = col[i];
    tr.appendChild(th);
  }

  //This Code adds data to table as rows
  for (var i = 0; i < data.length; i++) {

    tr = table.insertRow(-1);

    for (var j = 0; j < col.length; j++) {
      var tabCell = tr.insertCell(-1);
      tabCell.innerHTML = data[i][col[j]];
    }
  }

        //This Code gets the all columns for header
  
        var divContainer = document.getElementById(elementToBind);
        if(divContainer.hasChildNodes()){
          divContainer.replaceChildren(table);
        }
        else{
          divContainer.appendChild(table);
        }
      }

      const view_tracking = document.getElementById('view-tracking');
      const update_tracking = document.getElementById('update-tracking');
      var view_tracking_btn = document.querySelector('.view-tracking-btn');
      var update_tracking_btn = document.querySelector('.update-tracking-btn');

      function toggleTrackingMenu(id) {
        if(view_tracking.classList.contains("hidden") && id === 'view-tracking'){
          if(update_tracking_btn.classList.contains("clicked-button")){
            update_tracking_btn.classList.remove("clicked-button");
          }
          view_tracking_btn.classList.add("clicked-button");
          update_tracking.classList.add("hidden");
          view_tracking.classList.remove("hidden");
        }
        else if(update_tracking.classList.contains("hidden") && id === 'update-tracking'){
          if(view_tracking_btn.classList.contains("clicked-button")){
            view_tracking_btn.classList.remove("clicked-button");
          }
          update_tracking_btn.classList.add("clicked-button");
          view_tracking.classList.add("hidden");
          update_tracking.classList.remove("hidden");
        }
      };

      toggleTrackingMenu('');

      window.addEventListener("load", () => {
        timeclock();
        function timeclock() {
          const today = new Date();

          // get time components
          const hour = today.getHours();
          const minute = today.getMinutes();
          const second = today.getSeconds();

          //make clock a 12-hour time clock
          const hourTime = hour > 12 ? hour - 12 : hour;

          //assigning 'am' or 'pm' to indicate time of the day
          const ampm = hour < 12 ? "AM" : "PM";

          //get current time
          const time = hourTime + ":" + minute + ":" + second + " " + ampm;

          //print current time to the DOM
          document.getElementById('time-clock').innerHTML = time;
          setTimeout(timeclock, 1000);
          }
      });

      window.addEventListener("load", () => {
        dateclock();
        function dateclock() {
          const today = new Date();
          
          // get date components
          const month = today.getMonth();
          const year = today.getFullYear();
          const day = today.getDate();

          //declaring a list of all months in  a year
          const monthList = [
            "January",
            "February",
            "March",
            "April",
            "May",
            "June",
            "July",
            "August",
            "September",
            "October",
            "November",
            "December"
          ];

          //get current date
          const date = monthList[month] + " " + day + ", " + year;
          //print current date to the DOM
          document.getElementById('date-clock').innerHTML = date;
          setTimeout(dateclock, 10000);
          }
      });

/**************************** EMPLOYEE CLOCKIN / CLOCKOUT **********************************************************/

      function clockIn(){
        let username = document.getElementById('clockin-user-input').value;
        let password = document.getElementById('clockin-pass-input').value;

        let shift_start = document.getElementById('shift-start');
        const today = new Date();

        // get time components
        const hour = today.getHours();
        const minute = today.getMinutes();
        const second = today.getSeconds();

        //make clock a 12-hour time clock
        const hourTime = hour > 12 ? hour - 12 : hour;

        //assigning 'am' or 'pm' to indicate time of the day
        const ampm = hour < 12 ? "AM" : "PM";

        //get current time
        const time = hourTime + ":" + minute + ":" + second + " " + ampm;

        //print current time to the DOM
        shift_start.innerHTML = time;

  const data = {
    'username': username,
    'password': password
  };

        fetch(`${BASE_URL}/clockin`, {
          headers : {
            "Content-type": "application/json; charset=UTF-8"
          },
          method : 'POST',
          body : JSON.stringify(data)
        })
        .then(response => response.json())
        .then(data => {
          if(typeof data.alert === 'undefined'){
            alert(`You successfully clocked in!`);
          }
          else{
            alert('The username and/or password is incorrect!'); 
          }
        })
        .catch(error => (console.error('Fetch error:', error)));	
      }

      function clockOut(){
        let username = document.getElementById('clockin-user-input').value;
        let password = document.getElementById('clockin-pass-input').value;

        let shift_end = document.getElementById('shift-end');
        const today = new Date();

        // get time components
        const hour = today.getHours();
        const minute = today.getMinutes();
        const second = today.getSeconds();

        //make clock a 12-hour time clock
        const hourTime = hour > 12 ? hour - 12 : hour;

        //assigning 'am' or 'pm' to indicate time of the day
        const ampm = hour < 12 ? "AM" : "PM";

        //get current time
        const time = hourTime + ":" + minute + ":" + second + " " + ampm;

        //print current time to the DOM
        shift_end.innerHTML = time;

  const data = {
    'username': username,
    'password': password
  };

  console.log(data);
  fetch(`${BASE_URL}/clockout`, {
    headers : {
      "Content-type": "application/json; charset=UTF-8"
    },
    method : 'POST',
    body : JSON.stringify(data)
  })
  .then(response => response.json())
  .then(data => {
    if(typeof data.alert === 'undefined'){
      console.log(data)
      alert(`You successfully clocked out!`);
    }
    else{
      console.log(data)
      alert('The username and/or password is incorrect!'); 
    }
  })
  .catch(error => (console.error('Fetch error:', error)));	
}

////////////package overview//////////////
function overviewReport() {
  const startDate = document.getElementById('startDate').value;
  const endDate = document.getElementById('endDate').value;
  const packageType = document.getElementById('packageType').value;
  const status = document.getElementById('packageStatus').value;


  const packageInfo = {};


  // Add non-empty attributes to the packageInfo object
  if (startDate.trim() !== '') {
    packageInfo.firstDate = startDate;
  }
  if (endDate.trim() !== '') {
    packageInfo.secDate = endDate;
  }
  if (packageType.trim() !== '') {
    packageInfo.packageType = packageType;
  }
  if (status.trim() !== '') {
    packageInfo.status = status;
  }


  console.log(packageInfo);
 
  if (Object.keys(packageInfo).length > 0) {
    fetch(`${BASE_URL}/login/overview`, {
      headers: {
        "Content-type": "application/json; charset=utf-8"
      },
      method: 'POST',
      body: JSON.stringify(packageInfo)
    })
    .then(response => response.json())
  .then(data => {
    console.log(data);
    if (Array.isArray(data) && data.length > 0 && typeof data[0] === 'object') {
      overviewTable(data, "package_overview");
    } else {
      alert('No packages with selected filters found');
    }
  })
  .catch(error => console.error('Fetch error:', error));
} else {
  console.log('No data to send');
}

  function overviewTable(data, elementToBind) {           
    if (!Array.isArray(data) || data.length === 0 || typeof data[0] !== 'object') {
      console.error('No packages with selected filters found');
      return;
    }

    var col = [];
    for (var i = 0; i < data.length; i++) {
      for (var key in data[i]) {
        if (col.indexOf(key) === -1) {
          col.push(key);
        }
      }
    }

    var table = document.createElement("table");
    var tr = table.insertRow(-1);

    for (var i = 0; i < col.length; i++) {
      var th = document.createElement("th");
      th.innerHTML = col[i];
      tr.appendChild(th);
    }

    for (var i = 0; i < data.length; i++) {
    tr = table.insertRow(-1);

    for (var j = 0; j < col.length; j++) {
      var tabCell = tr.insertCell(-1);

      if (col[j] === 'Send Date' || col[j] === 'Receive Date') {
        // Check if the column represents a date
        const dateValue = new Date(data[i][col[j]]);
        tabCell.innerHTML = dateValue.toISOString().split('T')[0]; // Format date as 'YYYY-MM-DD'
      } else {
        tabCell.innerHTML = data[i][col[j]];
      }
    }
  }

    var divContainer = document.getElementById(elementToBind);
    divContainer.innerHTML = "";
    divContainer.appendChild(table);
  }
}



    </script>
    <!--<script src="./js/employee_home.js"></script>-->
  </body>
</html>